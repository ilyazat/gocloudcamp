# Тестовое задание для поступления в GoCloudCamp by ilyazat

## Задание №2. 
 Запустить проект:
```
docker-compose up
```
Запустить тесты(curl by ubuntu image):
```
sudo docker-compose -f docker-compose.yml -f docker-compose.test.yml up --abort-on-container-exit --exit-code-from testrunner
```
Открыть Swagger (after the containers is upped)
<a href="http://localhost:8080/docs"> Swagger </a>
## 1. Вопросы для разогрева

1. Опишите самую интересную задачу в программировании, которую вам приходилось решать?

Самой интересной задачей в программировании было реализацией протокола OAuth2.0 (Google) на нашем бэке. 
Сначала я читал протокол и жестко тупил, затем я реализовал Гугл авторизацию на своем маленьком тестовом проекте и понял,
чтО, куда передается и как выглядят запросы. Далее на проекте компании мы это применили и некоторое время фиксили.
Честно говоря, я восхищался красотой запросов, как все отлажено и как ни один элемет не получает лишней информации.
2. Расскажите о своем самом большом факапе? Что вы предприняли для решения проблемы?

К сожалению (или к счастью), факап этот не связан с программированием. Дело касается моей дипломной работы. 30 апреля я отправил свой диплом, ждущий правок, своему начному руководителю.
Шли дни и ответа я не получал. В день сдачи окончательной версии дипломной работы в проверяющую систему университета (12 мая) ни одного письма так и не было получено.
Я решил позвонить научному руководителю, но он не отвечал на звонки. Через знакомых мне удалось получить номер телефона
его жены (к счастью, она работала в университете) и я позвонил ей. Выяснилось, что научный руководитель забыл обо мне и мы в режиме реального времени исправляли неточности в дипломе.

Из этой ситуации я вынес такой вывод: в людей верить нужно, но все, что касается зоны моей личной ответственности, нужно всегда брать в свои руки.
Да, пришлось побеспокоить непричастных к сему делу людей, но проблему решить удалось и я в конце концов успешно прошел защиту своей работы.

3. Каковы ваши ожидания от участия в буткемпе?

Освоить один из самых перспективных в бэкенд разработке языков программирования, понять, как реализуются на нем задачи,
и, конечно же, получить удовольствие от разработки на строго типизированном ЯП!

---

## 2. Distributed config

### Описание

Реализовать сервис, который позволит динамически управлять конфигурацией приложений. Доступ к сервису должен осуществляться с помощью API. Конфигурация может храниться в любом источнике данных, будь то файл на диске, либо база данных. Для удобства интеграции с сервисом может быть реализована клиентская библиотека.

### Технические требования

* реализация задания может быть выполнена на любом языке программирования - Python✅
* формат схемы конфига на выбор: json/protobuf - json ✅
* сервис должен обеспечивать персистентность данных - ✅
* сервис должен поддерживать все CRUD операции по работе с конфигом - ✅
* должно поддерживаться версионирование конфига при его изменении - ✅
* удалять конфиг допускается только если он не используется никаким приложением - ✅

### Будет здорово, если:
* в качестве протокола взаимодействия сервиса с клиентами будете использовать gRPC - 
* напишите Dockerfile и docker-compose.yml - ✅
* покроете проект unit-тестами - ✅ (curl ubuntu image `tests/`)
* сделаете тестовый пример использования написанного сервиса конфигураций - ✅ (ниже)

### Пример использования сервиса

#### Создание конфига

`curl -d "@data.json" -H "Content-Type: application/json" -X POST http://localhost:8080/config`

```json
{
    "service": "managed-k8s",
    "data": [
        {"key1": "value1"},
        {"key2": "value2"}
    ]
}
```

```json
{"detail":"Config managed-k8s successfully created"}
```

#### Получение конфига

`curl http://localhost:8080/config?service=managed-k8s`

```json
{"key1": "value1", "key2": "value2"}
```
#### Редактирование конфига
`curl -X PUT -d "@data.json" -H 'accept: application/json' -H "Content-Type: application/json" http://localhost:8080/config`
```json
{
  "service": "managed-k8s",
  "data": [
    {"key1": "value1"},
    {"key2": "value2"},
    {"key3": "value3"}
  ]
}
```
```json
{"detail":"Config managed-k8s successfully updated"}
```

#### Версионирование 

<b>version = 1</b>

`curl -X 'GET' 'http://localhost:8080/config?service=managed-k8s&version=1' -H 'accept: application/json'`
```json
{"key1":"value1","key2":"value2"}
```
<b>version = 2</b>

`curl -X 'GET' 'http://localhost:8080/config?service=managed-k8s&version=2' -H 'accept: application/json'`
```json
{"key1":"value1","key2":"value2","key3":"value3"}
```

*По-умолчанию (без указания версии в query) доставляется самая последняя версия

#### Добавление приложения
`curl -X 'PUT' 'http://localhost:8080/config/add_app?service=managed-k8s&app_label=nginx' -H 'accept: application/json'`
```json
{"detail": "The app nginx has been added to service managed-k8s successfully"}
```

#### Удаление конфига с зависимым приложением
`curl -X 'DELETE' 'http://localhost:8080/config?service=managed-k8s' -H 'accept: application/json'`
```json
{"detail": "The config can't be deleted. One of the app uses it"}
```

#### Удаление приложения из конфига
`curl -X 'PUT' 'http://localhost:8080/configremove_app?service=managed-k8s&app_label=nginx' -H 'accept: application/json'`
```json
{"detail": "The app nginx has been removed from service managed-k8s successfully"}
```

#### Удаление конфига без зависимых приложений
`curl -X 'DELETE' 'http://localhost:8080/config?service=managed-k8s' -H 'accept: application/json'`

```json
{"detail": "Config managed-k8s successfully deleted"}
```

*По-умолчанию удаляется последняя версия конфига